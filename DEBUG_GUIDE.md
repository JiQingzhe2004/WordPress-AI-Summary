# DeepSeek AI 插件调试功能使用指南

## 概述

本插件现已集成完整的调试功能，帮助开发者更好地追踪和调试插件的运行状态。调试功能包括多级别日志记录、分模块调试开关以及可视化日志查看器。

## 调试功能特性

### 1. 多级别日志记录
- **DEBUG**: 详细的调试信息
- **INFO**: 一般信息记录
- **WARNING**: 警告信息
- **ERROR**: 错误信息

### 2. 分模块调试开关
- **调试模式总开关**: 控制整个插件的调试功能
- **调试级别**: 设置记录的最低日志级别
- **前端调试**: 控制前端相关的调试日志
- **AJAX调试**: 控制AJAX请求相关的调试日志
- **API调试**: 控制API调用相关的调试日志

### 3. 可视化日志查看器
- 实时查看调试日志
- 按级别高亮显示日志
- 支持清空和下载日志

## 使用方法

### 1. 启用调试模式

1. 进入WordPress管理后台
2. 导航到 "设置" > "DeepSeek AI 设置"
3. 找到 "调试设置" 部分
4. 勾选 "启用调试模式"
5. 选择合适的调试级别（建议开发时使用 "DEBUG"）
6. 根据需要启用特定模块的调试开关
7. 点击 "保存更改"

### 2. 查看调试日志

#### 方法一：在设置页面查看
1. 在设置页面向下滚动到 "调试日志查看器" 部分
2. 点击 "查看日志" 按钮
3. 日志将显示在下方的文本框中

#### 方法二：下载日志文件
1. 点击 "下载日志" 按钮
2. 系统将下载一个包含所有日志的文本文件

#### 方法三：查看浏览器控制台
- 当启用前端调试时，相关日志也会输出到浏览器控制台
- 按 F12 打开开发者工具，切换到 "Console" 标签页查看

### 3. 清空日志

当日志文件过大时，可以点击 "清空日志" 按钮清除所有历史日志。

## 调试场景示例

### 场景1：摘要不显示问题

1. 启用调试模式和前端调试
2. 访问有摘要的文章页面
3. 查看浏览器控制台，寻找以下信息：
   - 脚本加载状态
   - 摘要初始化过程
   - 打字机效果触发情况

### 场景2：API调用失败

1. 启用调试模式和API调试
2. 尝试生成摘要或SEO内容
3. 查看调试日志，寻找：
   - API请求参数
   - 响应状态码
   - 错误信息

### 场景3：AJAX请求问题

1. 启用调试模式和AJAX调试
2. 在文章编辑页面点击生成按钮
3. 查看调试日志，检查：
   - 请求发送状态
   - 响应处理过程
   - 错误处理情况

## 日志文件位置

调试日志存储在以下位置：
- **WordPress日志**: `wp-content/debug.log`（如果启用了WordPress调试）
- **插件专用日志**: `wp-content/uploads/deepseek-ai-debug.log`

## 性能注意事项

1. **生产环境**: 建议在生产环境中关闭调试模式，以避免性能影响
2. **日志大小**: 定期清理日志文件，避免占用过多磁盘空间
3. **调试级别**: 在生产环境中如需启用调试，建议只使用 "ERROR" 级别

## 常见问题

### Q: 为什么看不到调试日志？
A: 请确认：
- 调试模式已启用
- 相应的模块调试开关已打开
- 调试级别设置正确
- 有相关操作触发日志记录

### Q: 日志文件在哪里？
A: 日志文件位于 `wp-content/uploads/deepseek-ai-debug.log`

### Q: 如何在代码中添加调试日志？
A: 使用以下方法：
```php
// 在插件类中
$this->plugin->debug_log('调试信息');
$this->plugin->info_log('一般信息');
$this->plugin->warning_log('警告信息');
$this->plugin->error_log('错误信息');
```

### Q: 前端JavaScript如何输出调试信息？
A: 使用内置的DEBUG对象：
```javascript
DEBUG.log('调试信息');
DEBUG.log('错误信息', 'error');
DEBUG.log('警告信息', 'warn');
```

## 技术实现细节

### 后端调试
- 使用WordPress的`error_log()`函数记录日志
- 支持写入WordPress标准日志和插件专用日志
- 实现了日志级别过滤机制

### 前端调试
- 通过`wp_localize_script()`传递调试设置到前端
- 使用浏览器控制台API输出格式化日志
- 支持时间戳和日志级别标识

### 日志管理
- 提供AJAX接口获取、清空和下载日志
- 实现了nonce验证和权限检查
- 支持日志文件大小限制和自动清理

---

**注意**: 调试功能仅供开发和故障排除使用，请在生产环境中谨慎使用。